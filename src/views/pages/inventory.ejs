<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inventory</title>
    <link rel="stylesheet" href="/output.css" />
  </head>
  <body class="bg-[var(--base-white)] text-[var(--base-black)]">
    <%- include('../partials/header') %>

    <main class="container flex flex-col gap-8 mx-auto px-15 my-16">
      <h1 class="font-extrabold text-4xl max-w-lg leading-[1.3]">Inventory</h1>

      <div class="flex gap-12">
        <form
          method="GET"
          action="/inventory/filter"
          class="flex gap-12 flex-wrap items-end"
        >
          <!-- Filter by Category -->
          <div class="flex gap-2 items-center">
            <label for="category" class="font-bold text-lg">Category:</label>
            <div class="relative">
              <select
                id="category"
                name="category"
                class="h-12 w-[172px] appearance-none rounded-sm shadow-md border border-gray-300 px-4 focus:ring-2 bg-white text-[var(--base-black)]"
              >
                <option value="" disabled selected>Select Category</option>
                <option value="">All</option>
                <option value="meat">Meat</option>
                <option value="vegetable">Vegetable</option>
                <option value="dairy">Dairy</option>
                <option value="beverage">Beverage</option>
                <option value="snack">Snack</option>
              </select>
              <div
                class="pointer-events-none absolute inset-y-0 right-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 text-gray-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.27a.75.75 0 01.02-1.06z"
                    clip-rule="evenodd"
                  />
                </svg>
              </div>
            </div>
          </div>

          <!-- Filter by Status -->
          <div class="flex gap-2 items-center">
            <label for="status" class="font-bold text-lg">Status:</label>
            <div class="relative">
              <select
                id="status"
                name="status"
                class="h-12 w-[172px] appearance-none rounded-sm shadow-md border border-gray-300 px-4 focus:ring-2 bg-white text-[var(--base-black)]"
              >
                <option value="" disabled selected>Select Status</option>
                <option value="in stock">In Stock</option>
                <option value="low stock">Low Stock</option>
                <option value="expired">Expired</option>
                <option value="out of stock">Out of Stock</option>
              </select>
              <div
                class="pointer-events-none absolute inset-y-0 right-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 text-gray-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.27a.75.75 0 01.02-1.06z"
                    clip-rule="evenodd"
                  />
                </svg>
              </div>
            </div>
          </div>

          <!-- Sort By -->
          <!-- <div class="flex gap-2 items-center">
            <label for="sort" class="font-bold text-lg">Sort by:</label>
            <div class="relative">
              <select
                id="sort"
                name="sort"
                class="h-12 w-[172px] appearance-none rounded-sm shadow-md border border-gray-300 px-4 focus:ring-2 bg-white text-[var(--base-black)]"
              >
                <option value="" disabled selected>Select Sort by</option>
                <option value="-createdAt">Newest</option>
                <option value="createdAt">Oldest</option>
                <option value="itemName">Name A-Z</option>
                <option value="-itemName">Name Z-A</option>
                <option value="quantity">Quantity ↑</option>
                <option value="-quantity">Quantity ↓</option>
                <option value="expirationDate">Expiry Soonest</option>
                <option value="-expirationDate">Expiry Latest</option>
              </select>
              <div
                class="pointer-events-none absolute inset-y-0 right-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 text-gray-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.27a.75.75 0 01.02-1.06z"
                    clip-rule="evenodd"
                  />
                </svg>
              </div>
            </div>
          </div> -->

          <!-- Apply Button -->
          <button
            type="submit"
            class="h-12 px-6 bg-[var(--primary-clr)] text-white rounded-sm shadow-md font-semibold"
          >
            Apply Filters
          </button>
        </form>
      </div>

      <!-- Inventory Grid -->
      <div class="grid grid-cols-4 gap-4">
        <% items.forEach(item => { %>
        <div class="relative border rounded-lg shadow-md overflow-hidden group">
          <!-- Card is a link (except buttons) -->
          <a
            href="/inventory/details/<%= item._id %>"
            class="block p-5 hover:bg-gray-100 transition"
          >
            <h1 class="text-2xl font-bold mb-1"><%= item.itemName %></h1>
            <p class="text-sm text-gray-600"><%= item.category %></p>
            <p class="text-sm mb-2"><%= item.quantity %> <%= item.unit %></p>
            <p class="text-xs text-gray-500">
              Exp Date: <%= item.formattedTime %>
            </p>
            <p class="text-xs">Status: <%= item.status %></p>
          </a>

          <!-- Buttons (outside of <a>, not part of clickable card) -->
          <div class="flex gap-2 px-5 pb-4 pt-2">
            <a href="/inventory/edit/<%= item._id %>">
              <button
                class="bg-[var(--primary-clr)] rounded-sm text-white px-8 py-1"
              >
                Edit
              </button>
            </a>
            <form action="/inventory/delete/<%= item._id %>" method="POST">
              <button
                type="submit"
                class="bg-red-600 text-white px-4 py-1 rounded hover:bg-red-700"
              >
                Delete
              </button>
            </form>
          </div>
        </div>
        <% }); %>
      </div>
    </main>
  </body>
</html>
